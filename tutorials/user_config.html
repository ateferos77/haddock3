

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Workflow configuration files &mdash; haddock3 3.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Editing and extending runs" href="continuing_runs.html" />
    <link rel="prev" title="Advanced features" href="index.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="../index.html">
                haddock3
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="../index.html">Docs</a></li>
        
          <li><a href="index.html">Advanced features</a></li>
        
      <li>Workflow configuration files</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/user_config.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="../search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">A brieft introduction to HADDOCK3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#clone-this-repository">1. Clone this repository:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#create-a-virtual-environment-with-python-3-9-and-install-dependencies">2 Create a virtual environment with Python 3.9+ and install dependencies:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#install-the-haddock3-package-and-command-line-clients">3. Install the HADDOCK3 package and command line clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#make-a-cns-binary-shortcut-to-the-expected-path">4. Make a CNS binary shortcut to the expected path:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#keep-your-installation-up-to-date">5. Keep your installation up to date</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#optional-install-mpi-libraries-if-you-intend-to-run-haddock3-with-mpi">6. (Optional) Install MPI libraries if you intend to run HADDOCK3 with MPI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html#installing-third-party-packages">Installing third-party packages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#lightdock"><code class="docutils literal notranslate"><span class="pre">lightdock</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#gdock"><code class="docutils literal notranslate"><span class="pre">gdock</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../USAGE.html">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../USAGE.html#run-haddock3">Run HADDOCK3</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Workflow Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-antibogy-antigen">docking-antibogy-antigen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-dna">docking-protein-dna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-homotrimer">docking-protein-homotrimer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-ligand">docking-protein-ligand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-ligand-shape">docking-protein-ligand-shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-peptide">docking-protein-peptide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-protein">docking-protein-protein</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#refine-complex">refine-complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#scoring">scoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-multiple-ambig">docking-multiple-ambig</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Advanced features</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#haddock3-functionalities">HADDOCK3 functionalities</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tutorials-for-developers">Tutorials for developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../clients/index.html">Command-line interfaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../clients/clihd3.html">Run HADDOCK3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clicfg.html">Retrieve config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/cliscore.html">Calculate score</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clipp.html">PDB preprocessing client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clicp.html">Copy steps to new run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/cliclean.html">Clean HADDOCK3 runs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/cliunpack.html">Unpack HADDOCK3 run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/climpi.html">HADDOCK3 MPI Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clibm.html">Benchmark Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clidmn.html">Benchmark Daemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clianalyse.html">Analysis client</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/topology/index.html">Topology Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/sampling/index.html">Sampling Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/refinement/index.html">Model Refinement Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/scoring/index.html">Scoring Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/analysis/index.html">Analysis Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/extras/index.html">Extra modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#module-haddock.modules">Parent code for modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#module-haddock.modules.base_cns_module">Parent code for CNS modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#general-default-parameters">General Default parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/integration_tests.html">Running integration tests manually</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to HADDOCK3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#contributing-new-code">1. Contributing new code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#contributing-with-documentation">2. Contributing with documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Library Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/core/index.html">Core Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/libs/index.html">Libs Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/gear/index.html">Gear Reference</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <section id="workflow-configuration-files">
<h1>Workflow configuration files<a class="headerlink" href="#workflow-configuration-files" title="Permalink to this heading">¶</a></h1>
<p>Users can configure HADDOCK3 workflows through human-readable text files. The
configuration file is divided into two sections. The first contains the general
<strong>mandatory</strong> and <strong>optional</strong> parameters. The second section contains the
configuration parameters for each <strong>step</strong> in the workflow. The workflow steps
are defined by a title header with the module’s name to execute followed by its
parameters. The <code class="docutils literal notranslate"><span class="pre">parameter</span> <span class="pre">=</span> <span class="pre">value</span></code> pair definitions follow strictly the TOML
syntax. However, contrarily to TOML, in HADDOCK3 configuration files can have
headers with repeated names.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="c1"># first section: general parameters =======</span>
<span class="c1"># mandatory parameters</span>
<span class="n">run_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;run1-test&quot;</span>

<span class="n">molecules</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p">[</span>
<span class="w">    </span><span class="s">&quot;data/mol1.pdb&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;data/mol2.pdb&quot;</span>
<span class="w">    </span><span class="p">]</span>

<span class="c1"># optional parameters</span>
<span class="n">ncores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">40</span>

<span class="c1"># second section: step parameters =======</span>
<span class="c1"># each workflow step executes a HADDOCK3 module</span>
<span class="c1"># the step&#39;s header is the name of the module</span>
<span class="c1"># the step&#39;s paramereters are defined below its header</span>
<span class="k">[topoaa]</span>
<span class="n">autohis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="k">[topoaa.mol1]</span>
<span class="n">nhisd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">nhise</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="n">hise_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">75</span>
<span class="k">[topoaa.mol2]</span>
<span class="n">nhisd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="n">hisd_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">76</span>
<span class="n">nhise</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="n">hise_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span>

<span class="k">[rigidbody]</span>
<span class="n">tolerance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span>
<span class="n">ambig_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;data/mol1.tbl&quot;</span>
<span class="n">sampling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span>

<span class="k">[caprieval]</span>
<span class="n">reference_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;data/mol1-mol2.pdb&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are a developer and wish to know more details, see the
<a class="reference internal" href="../reference/gear/config.html#module-haddock.gear.config" title="haddock.gear.config"><code class="xref py py-mod docutils literal notranslate"><span class="pre">haddock.gear.config</span></code></a> module.</p>
</div>
<p>Each module does have default parameters defined and HADDOCK3 will use those
default values unless those are specified and changed by the user in the
configuration file.</p>
<p>To obtain the list of all parameters for each module, you can use the
<code class="docutils literal notranslate"><span class="pre">haddock-cfg</span></code> command-line. For example, to list all parameters from the
<em>All-atom topology</em> module (<code class="docutils literal notranslate"><span class="pre">topoaa</span></code>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>haddock-cfg<span class="w"> </span>-m<span class="w"> </span>topoaa

<span class="c1"># or to write the output to a file</span>
haddock-cfg<span class="w"> </span>-m<span class="w"> </span>topoaa<span class="w"> </span>&gt;<span class="w"> </span>topoaa_defaults.cfg

<span class="c1"># obtain help on `haddoc-cfg` CLI</span>
haddock-cfg<span class="w"> </span>-h
</pre></div>
</div>
<p>The HADDOCK3 workflow will follow the order of the steps defined in the
configuration file, reading from top to bottom. For the example above, that
would be: <code class="docutils literal notranslate"><span class="pre">topoaa</span></code>, <code class="docutils literal notranslate"><span class="pre">rigidbody</span></code>, <code class="docutils literal notranslate"><span class="pre">caprieval</span></code>. Therefore, to edit/add/remove
steps in a HADDOCK3 workflow, you simply need to add/remove/edit the text blocks
referring to each module.</p>
<p>Moreover, you can define the general <strong>optional</strong> parameters in the global scope of the
workflow or specifically for each module. Optional parameters defined in the
general scope of the configuration files affect all modules. While those
described inside a step will affect only that step. For example:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">run_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;run1-test&quot;</span>

<span class="n">molecules</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p">[</span>
<span class="w">    </span><span class="s">&quot;data/mol1.pdb&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;data/mol2.pdb&quot;</span>
<span class="w">    </span><span class="p">]</span>

<span class="c1"># each .job will produce 5 (or less) models</span>
<span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hpc&quot;</span>
<span class="n">concat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>

<span class="k">[topoaa]</span>
<span class="n">autohis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>

<span class="k">[rigidbody]</span>
<span class="n">ambig_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;data/mol1.tbl&quot;</span>
<span class="n">sampling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span>

<span class="k">[caprieval]</span>
<span class="n">reference_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;data/mol1-mol2.pdb&quot;</span>

<span class="k">[flexref]</span>
<span class="c1"># flexref jobs are bound to generate one model per job</span>
<span class="c1"># therefore, we can specify the &#39;concat&#39; parameter specifically for flexref</span>
<span class="n">concat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="n">ambig_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;data/mol1.tbl&quot;</span>

<span class="k">[caprieval]</span>
<span class="n">reference_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;data/mol1-mol2.pdb&quot;</span>
</pre></div>
</div>
<p>Inside the <a class="reference external" href="https://github.com/haddocking/haddock3/tree/main/examples">examples</a> subfolders you will
a panoply of examples of workflow configuration files (<code class="docutils literal notranslate"><span class="pre">.cfg</span></code>).</p>
<p>Here is a list of all available <a class="reference internal" href="../modules/index.html#modules"><span class="std std-ref">Modules</span></a>.</p>
<p>Finally, if you are a developer and wish to use HADDOCK3 as a library to read
and write configuration files please see the related Python modules:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../reference/gear/config.html#module-haddock.gear.config"><span class="std std-ref">Configuration file I/O</span></a></p></li>
</ul>
<p>For example, to read a workflow configuration file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">haddock.gear.config</span> <span class="kn">import</span> <span class="n">load</span>

<span class="n">config_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">,</span> <span class="s2">&quot;config.cfg&quot;</span><span class="p">)</span>
<span class="n">config_dict</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
</pre></div>
</div>
<section id="compatibility-with-toml">
<h2>Compatibility with TOML<a class="headerlink" href="#compatibility-with-toml" title="Permalink to this heading">¶</a></h2>
<p>HADDOCK3 actually uses <a class="reference external" href="https://pypi.org/project/toml/">TOML</a> to read the
configuration files. However, some additional features are introduced to enhance
user experience. For example, the capability to repeat header names. Hence,
HADDOCK3 can also read pure TOML files as workflow configuration files. For
those cases, repeated modules should have a trailing integer in their
definition:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[topoaa]</span>
<span class="c1"># parameters here...</span>

<span class="k">[rigidbody]</span>
<span class="c1"># parameters here...</span>

<span class="k">[caprieval]</span>
<span class="c1"># parameters here...</span>

<span class="k">[flexref]</span>
<span class="c1"># parameters here...</span>

<span class="k">[&#39;caprieval.2&#39;]</span>
<span class="c1"># parameters here...</span>
</pre></div>
</div>
<p>The exact trailing integer is irrelevant as long as headers are not repeated.
HADDOCK3 will normalize the integers when reading the config file. For example,
the example below is the same as the above example. What matters is the
order in which the steps are presented in the configuration file.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[topoaa]</span>
<span class="c1"># parameters here...</span>

<span class="k">[rigidbody]</span>
<span class="c1"># parameters here...</span>

<span class="p">[</span><span class="s">&#39;caprieval.10&#39;</span><span class="p">]</span><span class="w">  </span><span class="c1"># &lt;- mind the 10 here</span>
<span class="c1"># parameters here...</span>

<span class="k">[flexref]</span>
<span class="c1"># parameters here...</span>

<span class="k">[&#39;caprieval.2&#39;]</span>
<span class="c1"># parameters here...</span>
</pre></div>
</div>
</section>
</section>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.0.0',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright 2022, BonvinLab.
        Last updated on Jan 06, 2023.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.
        </div>
    </div>  

</body>
</html>