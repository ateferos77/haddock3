

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HADDOCK3 benchmark tutorial &mdash; haddock3 3.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Command-line interfaces" href="../clients/index.html" />
    <link rel="prev" title="Running HADDOCK3 with MPI" href="mpi.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="../index.html">
                haddock3
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="../index.html">Docs</a></li>
        
          <li><a href="index.html">Advanced features</a></li>
        
      <li>HADDOCK3 benchmark tutorial</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/benchmark.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="../search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">A brief introduction to HADDOCK3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#clone-this-repository">1. Clone this repository:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#create-a-virtual-environment-with-python-3-9-and-install-dependencies">2 Create a virtual environment with Python 3.9+ and install dependencies:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#install-the-haddock3-package-and-command-line-clients">3. Install the HADDOCK3 package and command line clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#make-a-cns-binary-shortcut-to-the-expected-path">4. Make a CNS binary shortcut to the expected path:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#keep-your-installation-up-to-date">5. Keep your installation up to date</a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#optional-install-mpi-libraries-if-you-intend-to-run-haddock3-with-mpi">6. (Optional) Install MPI libraries if you intend to run HADDOCK3 with MPI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../INSTALL.html#installing-third-party-packages">Installing third-party packages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#lightdock"><code class="docutils literal notranslate"><span class="pre">lightdock</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../INSTALL.html#gdock"><code class="docutils literal notranslate"><span class="pre">gdock</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../USAGE.html">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../USAGE.html#run-haddock3">Run HADDOCK3</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Workflow Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-antibogy-antigen">docking-antibogy-antigen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-dna">docking-protein-dna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-homotrimer">docking-protein-homotrimer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-ligand">docking-protein-ligand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-ligand-shape">docking-protein-ligand-shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-peptide">docking-protein-peptide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-protein-protein">docking-protein-protein</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#refine-complex">refine-complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#scoring">scoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#docking-multiple-ambig">docking-multiple-ambig</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Advanced features</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#haddock3-functionalities">HADDOCK3 functionalities</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#tutorials-for-developers">Tutorials for developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../clients/index.html">Command-line interfaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../clients/clihd3.html">Run HADDOCK3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clicfg.html">Retrieve config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/cliscore.html">Calculate score</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clipp.html">PDB preprocessing client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clicp.html">Copy steps to new run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/cliclean.html">Clean HADDOCK3 runs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/cliunpack.html">Unpack HADDOCK3 run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/climpi.html">HADDOCK3 MPI Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clibm.html">Benchmark Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clidmn.html">Benchmark Daemon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/clianalyse.html">Analysis client</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/topology/index.html">Topology Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/sampling/index.html">Sampling Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/refinement/index.html">Model Refinement Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/scoring/index.html">Scoring Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/analysis/index.html">Analysis Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/extras/index.html">Extra modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#module-haddock.modules">Parent code for modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#module-haddock.modules.base_cns_module">Parent code for CNS modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#general-default-parameters">General Default parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/integration_tests.html">Running integration tests manually</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to HADDOCK3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#contributing-new-code">1. Contributing new code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#contributing-with-documentation">2. Contributing with documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Library Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/core/index.html">Core Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/libs/index.html">Libs Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/gear/index.html">Gear Reference</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <section id="haddock3-benchmark-tutorial">
<h1>HADDOCK3 benchmark tutorial<a class="headerlink" href="#haddock3-benchmark-tutorial" title="Permalink to this heading">¶</a></h1>
<p>Developing HADDOCK3 requires handling thousands of parameters, either at
the CNS level or the Python level. Therefore, unit-testing is sometimes
not enough. To assess the correct functioning of HADDOCK3 we have
assembled a benchmarking workflow where we dock well known and studied
complexes and ensure the outcome matches expectations.</p>
<p>To run HADDOCK3 as a user, you don’t need to run this benchmark. But if
you are an advanced user who has configured HADDOCK3 in your systems,
you may wish to run the benchmark to make sure HADDOCK3 behaves as
expected.</p>
<p>HADDOCK3 has two command-line clients that set up the benchmark workflow
automatically. Let’s go through them step-by-step.</p>
<section id="obtaining-the-initial-models">
<h2>Obtaining the initial models<a class="headerlink" href="#obtaining-the-initial-models" title="Permalink to this heading">¶</a></h2>
<p>The Bonvin lab has manually curated a list of systems ideal for this
benchmark. The repository is available here. Clone it to your machine
with:</p>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/haddocking/BM5-clean</span></code></p>
<p>If you inspect the new <code class="docutils literal notranslate"><span class="pre">BM5-clean</span></code> folder, you will see the
<code class="docutils literal notranslate"><span class="pre">HADDOCK-ready</span></code> folder has more than 200 sub-folders with “ready-to-use”
systems for HADDOCK.</p>
</section>
<section id="setting-up-the-runs">
<h2>Setting up the runs<a class="headerlink" href="#setting-up-the-runs" title="Permalink to this heading">¶</a></h2>
<p>Having HADDOCK3 installed, you can set up the runs with the following
command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># first, make a new folder where you want the runs to be stored</span>
<span class="n">mkdir</span> <span class="o">&lt;</span><span class="n">folder</span><span class="o">-</span><span class="n">where</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">BM</span><span class="o">-</span><span class="n">jobs</span><span class="o">-</span><span class="n">will</span><span class="o">-</span><span class="n">be</span><span class="o">-</span><span class="n">created</span><span class="o">&gt;</span>
<span class="n">haddock3</span><span class="o">-</span><span class="n">bm</span> <span class="n">BM5</span><span class="o">-</span><span class="n">clean</span><span class="o">/</span><span class="n">HADDOCK</span><span class="o">-</span><span class="n">ready</span> <span class="o">&lt;</span><span class="n">folder</span><span class="o">-</span><span class="n">where</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">BM</span><span class="o">-</span><span class="n">jobs</span><span class="o">-</span><span class="n">will</span><span class="o">-</span><span class="n">be</span><span class="o">-</span><span class="n">created</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">[OPTIONS]</span></code> are optional :relaxed:. Look at the <code class="docutils literal notranslate"><span class="pre">haddock3-bm</span> <span class="pre">-h</span></code> help
menu and select which ones better adapt to your system.</p>
</section>
<section id="running-with-the-daemon">
<h2>Running with the daemon<a class="headerlink" href="#running-with-the-daemon" title="Permalink to this heading">¶</a></h2>
<p>Running more than 200 HADDOCK jobs is time-consuming. Inspecting the
queue system manually over several days is a pain. Therefore, we created
a daemon that will handle the queue and submit the jobs for you. Use the
command:</p>
<p><code class="docutils literal notranslate"><span class="pre">haddock3-dmn</span> <span class="pre">&lt;folder-where-the-BM-jobs-were-created&gt;</span> <span class="pre">[OPTIONS]</span></code></p>
<p>Use <code class="docutils literal notranslate"><span class="pre">haddock3-dmn</span> <span class="pre">-h</span></code> to read all possible options.</p>
<p>From this point on, the daemon will manage the queue for you. You can
also run the daemon as a job; please read further.</p>
<p>Initially, all jobs have a file named <code class="docutils literal notranslate"><span class="pre">AVAILABLE</span></code> pointing that the jobs
are ready to run. Jobs that are sent to the queue get the file flag
<code class="docutils literal notranslate"><span class="pre">RUNNING</span></code>. Completed jobs get the file flag <code class="docutils literal notranslate"><span class="pre">DONE</span></code>, and failed jobs get
the file flag <code class="docutils literal notranslate"><span class="pre">FAIL</span></code>.You can inspect which jobs are at which state with
the <code class="docutils literal notranslate"><span class="pre">find</span></code> command:</p>
<p><code class="docutils literal notranslate"><span class="pre">find</span> <span class="pre">&lt;folder-where-the-BM-jobs-were-created&gt;</span> <span class="pre">-name</span> <span class="pre">DONE</span></code></p>
<p>You can count the number of folders with:</p>
<p><code class="docutils literal notranslate"><span class="pre">find</span> <span class="pre">&lt;folder-where-the-BM-jobs-were-created&gt;</span> <span class="pre">-name</span> <span class="pre">DONE</span> <span class="pre">|</span> <span class="pre">wc</span> <span class="pre">-l</span></code></p>
</section>
<section id="stopping-the-daemon">
<h2>Stopping the daemon<a class="headerlink" href="#stopping-the-daemon" title="Permalink to this heading">¶</a></h2>
<p>If you want to stop the daemon, press <code class="docutils literal notranslate"><span class="pre">Ctrl+c</span></code> in the window where you
launch it. And manually cancel the remaining jobs. You can try the
following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">-a</span> <span class="pre">|</span> <span class="pre">awk</span> <span class="pre">'{print</span> <span class="pre">$4}'</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">BM5</span> <span class="pre">|</span> <span class="pre">xargs</span> <span class="pre">scancel</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">BM5</span></code> comes because all jobs prepared for the benchmark have the <code class="docutils literal notranslate"><span class="pre">BM5</span></code>
tag in their job name (unless you defined otherwise in the <code class="docutils literal notranslate"><span class="pre">[OPTIONS]</span></code>)</p>
</section>
<section id="further-notes">
<h2>Further notes<a class="headerlink" href="#further-notes" title="Permalink to this heading">¶</a></h2>
<p>As with any command-line tool, the haddock3-daemon will run as long as
the terminal window is open. However, we don’t recommend using the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>
terminal detacher suffix command unless you know what you do.
Alternatively, you could use <a class="reference external" href="https://github.com/tmux/tmux"><code class="docutils literal notranslate"><span class="pre">tmux</span></code></a> to
maintain the session running even when you disconnect from your login
node.</p>
<p>A better way can be to send the daemon job to some queue. You can easily
do that by using the daemon job created by the <code class="docutils literal notranslate"><span class="pre">haddock3-bm</span></code> command.</p>
</section>
<section id="what-happens-if-you-halt-the-daemon">
<h2>What happens if you halt the daemon?<a class="headerlink" href="#what-happens-if-you-halt-the-daemon" title="Permalink to this heading">¶</a></h2>
<p>If you halt the daemon, you can restart the operations from where they
left. Two scenarios are possible:</p>
<ol class="arabic simple">
<li><p>you also canceled running jobs</p></li>
<li><p>you let the running jobs finish properly</p></li>
</ol>
<p>In the first scenario, you want the previously running jobs to restart.
For that, run the command:</p>
<p><code class="docutils literal notranslate"><span class="pre">haddock3-dmn</span> <span class="pre">&lt;new-folder-of-my-preference&gt;</span> <span class="pre">--restart</span> <span class="pre">[OPTIONS]</span></code></p>
<p>Or you can update the <code class="docutils literal notranslate"><span class="pre">hd3-daemon.job</span></code> file with the <code class="docutils literal notranslate"><span class="pre">--restart</span></code> option.</p>
<p>In the second scenario, run the daemon as you would from scratch. Only
the jobs with the file flag <code class="docutils literal notranslate"><span class="pre">AVAILABLE</span></code> will be executed.</p>
<p>Thanks for using HADDOCK3. <a class="reference external" href="https://github.com/haddocking/haddock3/issues">Any feedback is very
welcomed</a>.</p>
<p>The HADDOCK team.</p>
</section>
</section>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.0.0',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright 2022, BonvinLab.
        Last updated on Sep 11, 2023.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 6.2.1.
        </div>
    </div>  

</body>
</html>